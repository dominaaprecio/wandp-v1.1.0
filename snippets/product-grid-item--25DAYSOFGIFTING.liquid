{% capture checkDate %}{{ 'now' | date: '%d' }}{% endcapture %}
{% assign todaysDate = checkDate | plus: 0 %}
{% assign todaysGift = false %}
{% assign isGift = false %}
{% for collection in product.collections %}
  {% if isGift == false and collection.handle == '25days' %}
    {% assign isGift = true %}
  {% endif %}
{% endfor %}
{% if isGift %}
  {% for day in collections['25days'].products %}
    {% if forloop.index == todaysDate and day.title contains product.title %}
      {% assign todaysGift = true %}
    {% endif %}
  {% endfor %}
{% endif %}

      <div class="text-center grid__product">
        <input type="hidden" value="{{ product.url | within: collection }}" class="grid__product__url">
        {% if product.featured_image != blank %}
          <div class="grid__product-img">
            {% if todaysGift %}
            <div class="grid__product-sale">
              <span>25% Off</span>
            </div>
            {% endif %}
            <a href="{{ product.url | within: collection }}">
              <img src="{{ product.featured_image.src | img_url: '1000x1000', crop: 'center' }}" class="grid__featured">
              {% unless product.images.size == 1 %}
                <div class="grid__product-hover">
                  <img src="{{ product.images[1] | img_url: '1000x1000', crop: 'center' }}" alt="{{ product.title }}" class="grid__hover">
                </div>
              {% endunless %}
              {% if product.options.first contains "Color" %}
                <div class="grid__product-variants">

                  {% for product in product.images %}
                    {% assign first_color = forloop.index0 %}
                    {% assign all_colors = '' %}
                    {% assign selected_color = '' %}
                    {% for variant in product.variants %}
                      {% capture selected_color %}
                        {{ variant.options[first_color] }}
                      {% endcapture %}

                      <img style="display: none;" src="{{ variant.image | img_url: '1000x1000', crop: 'center' }}" alt="{{ product.title }} - {{ variant.option1 }}" id="{{ variant.id }}" class="grid__variant {{ variant.option1 | handleize }}">
                      {% capture temp_colors %}
                        {{ all_colors | append: selected_color | append: ' ' }}
                      {% endcapture %}
                      {% assign all_colors = temp_colors %}

                    {% endfor %}

                  {% endfor %}

                </div>
              {% endif %}
            </a>
          </div>
        {% endif %}

        <p class="weight800">
          <a href="{{ product.url | within: collection }}">{{ product.title }}</a>
        </p>
        <p>
          {% if todaysGift %}
            {% assign saleDiscount = product.price | times: 0.25 %}
            {% assign salePrice = product.price | minus: saleDiscount %}
            <s>{{ product.price | money }}</s> <span class="sale-price">{{ salePrice | money }}</span>
          {% else %}
            {% if product.compare_at_price > product.price %}
              <span class="visually-hidden">{{ 'products.product.regular_price' | t }}</span>
              <s>{{ product.compare_at_price | money }}</s>
              {{ product.price | money }}

            {% else %}
              {{ product.price | money }}
            {% endif %}
          {% endif %}
          {% unless product.available %}
            {{ 'products.product.sold_out' | t }}
          {% endunless %}
        </p>
        {% if template contains 'collection' %}
          {% if product.variants.size > 1 %}
            {% if product.options.first contains "Color" %}
              <div class="swatch swatch--collection grid__swatches">
                {% for option in product.options %}
                  {% if option == "Color" or option == "Colour" %}
                    {%- assign index = forloop.index0 -%}
                    {%- assign colorlist = '' -%}
                    {%- assign color = '' -%}
                    {% for variant in product.variants %}
                      {%- capture color -%}
                        {{ variant.options[index] }}
                       {%- endcapture -%}
                      {% unless colorlist contains color %}
                        <div id="color-{{ color | handleize }}" data-value="{{ color }}" class="swatch-element color {% if product.vendor == 'Porter' or product.title contains 'LUNCH! Set' %}porter-{% endif %}{{ color | handleize }}{% if forloop.first %} active{% endif %}" data-url="{{ variant.url | within: collection }}" data-id="{{ variant.id }}">
                          <label></label>
                        </div>
                        {% capture tempList %}
                          {{ colorlist | append: color | append: ' ' }}
                        {% endcapture %}
                        {%- assign colorlist = tempList -%}
                      {% endunless %}
                    {% endfor %}
                  {% endif %}
                {% endfor %}
              </div>
            {% endif %}
          {% endif %}
        {% endif %}
      </div>